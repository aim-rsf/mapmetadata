<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>mapmetadata tutorial • mapmetadata</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="mapmetadata tutorial">
<script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mapmetadata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/mapmetadata.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/HealthMetadata.html">Health metadata</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aim-rsf/mapmetadata/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>mapmetadata tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/aim-rsf/mapmetadata/blob/main/vignettes/mapmetadata.Rmd" class="external-link"><code>vignettes/mapmetadata.Rmd</code></a></small>
      <div class="d-none name"><code>mapmetadata.Rmd</code></div>
    </div>

    
    
<p>For installation, set-up and basic usage refer to the package <a href="https://aim-rsf.github.io/mapmetadata/index.html">README.md</a>
file. In this tutorial, you will find more context on package inputs,
how to interact with package functions and interpret package
outputs.</p>
<div class="section level2">
<h2 id="preparing-for-mapping">Preparing for mapping<a class="anchor" aria-label="anchor" href="#preparing-for-mapping"></a>
</h2>
<p><img src="https://raw.githubusercontent.com/aim-rsf/mapmetadata/main/inst/outputs/BAR_360_NationalCommunityChildHealthDatabase(NCCHD)_2024-12-19-18-07-22.png" alt="example bar plot showing number of variables for each table alongside counts of whether variables have missing descriptions"></p>
<p>This bar plot is produced automatically when you run the
<code>metadata_map</code> function. The bar plot can help you understand
the scope of the dataset, but reference the HDRUK Gateway page for the
fuller context. For instance, table descriptions are not included in
these structural metadata files but they are included on the
gateway:</p>
<p><strong>For dataset NCCHD, used in the demo, the structural metadata
was downloaded here:</strong></p>
<p><img src="https://raw.githubusercontent.com/aim-rsf/mapmetadata/main/inst/outputs/inst/outputs/NCCHD_gateway_download.png" alt="screenshot of HRDRUK gateway showing location to download structural metadata"></p>
<p><strong>View descriptions of each table to give you more context on
their contents and how to use them:</strong></p>
<p><img src="https://raw.githubusercontent.com/aim-rsf/mapmetadata/main/inst/outputs/inst/outputs/NCCHD_gateway_table.png" alt="screenshot of HRDRUK gateway showing table descriptions"></p>
<p>The bar plot shows us there are 13 tables in the dataset. The height
of the bar indicates the number of variables in that table:</p>
<ul>
<li>The ones with lots of variables (e.g. CHILD_TRUST) will take you
longer to process</li>
<li>Some tables (e.g. CHE_HEALTHYCHILDWALESPROGRAMME) have a lot of
empty descriptions. An empty description means that this variable will
only have a label and a data type.</li>
</ul>
<p>It is important to note that this plot is only summarising
<em>variable</em> level metadata i.e. a description of what the variable
is. Some variables also require <em>value</em> level metadata i.e. what
does each value correspond to, 1 = Yes, 2 = No, 3 = Unknown. This
<em>value</em> level metadata can sometimes be found in lookup tables,
if it is not provided within the <em>variable</em> level
description.</p>
</div>
<div class="section level2">
<h2 id="mapping">Mapping<a class="anchor" aria-label="anchor" href="#mapping"></a>
</h2>
<p>Use the bar plot and the HDRUK Gateway to guide your mapping choices.
The main functionality of this package is to aid a researcher in mapping
variables from health datasets onto their research domains
(concepts/latent variables).</p>
<p>You will see this in the R console:</p>
<p><code>Press 'Esc' key to finish here, or press any other key to continue with mapping variables</code></p>
<p>Pressing any key will move you to the mapping phase. Demo mode (run
by <code><a href="../reference/metadata_map.html">metadata_map()</a></code>) only processes the fist 20 data elements
(variables) in the selected table.</p>
<pre><code>Enter your initials: rs

Enter the table number you want to process: 

 1: BLOOD_TEST    
 2: BREAST_FEEDING                   
 3: CHE_HEALTHYCHILDWALESPROGRAMME   
 4: CHILD                   
 5: CHILD_BIRTHS  
 6: CHILD_MEASUREMENT_PROGRAM        
 7: CHILD_TRUST                      
 8: EXAM                    
 9: IMM           
 10: PATH_BLOOD_TESTS                
 11: PATH_SPCM_DETAIL                
 12: REFR_IMM_VAC            
 13: SIG_COND                        

Selection: 4

ℹ Processing Table 4 of 13 (CHILD)

Optional free text note about this table (or press enter to continue): tutorial testing</code></pre>
<p>You will be asked to label data elements with one (or more) of the
numbers shown in the Plots tab [0-7]. Here we have very simple domains
[4-7] for the demo run. For a research study, your domains are likely to
be much more specific e.g. ‘Prenatal, antenatal, neonatal and birth’ or
‘Health behaviours and diet’. The 4 default domains are always included
[0-3], appended on to any domain list given by the user.</p>
<p><img src="https://raw.githubusercontent.com/aim-rsf/mapmetadata/main/inst/outputs/plots_tab_demo_domains.png" alt="description of research domains used for categorisations" width="25%"></p>
<p>If it skips over a data element it means it was auto-categorised or
copied from a previous table already processed (more on that later).</p>
<pre><code>ℹ 20 left to process in this session
✔ Processing data element 1 of 35

ℹ 19 left to process in this session
✔ Processing data element 2 of 35

ℹ 18 left to process in this session
✔ Processing data element 3 of 35

ℹ 17 left to process in this session
✔ Processing data element 4 of 35

DATA ELEMENT -----&gt;  APGAR_1 

DESCRIPTION -----&gt;  APGAR 1 score. This is a measure of a baby's physical state at birth with particular reference to asphyxia - taken at 1 minute. Scores 3 and below are generally regarded as critically low; 4-6 fairly low, and 7-10 generally normal. Field can contain high amount of unknowns/non-entries. 

DATA TYPE -----&gt;  CHARACTER 

Categorise data element into domain(s). E.g. 3 or 3,4: 7

Categorisation note (or press enter to continue): your note here </code></pre>
<p>We chose to respond with ‘7’ because that corresponds to the ‘Health
info’ domain in the table. More than one domain can be chosen, separated
by commas. Do remember that this demo has over-simplified domain labels,
and they will likely be more specific for a research study.</p>
<p>You have the option to re-do the categorisation (and note) you just
made, by replying ‘y’ to the question:</p>
<pre><code>Response to be saved is '7'. Would you like to re-do? (y/n): n</code></pre>
<p>After completing 20, it will then ask you to review the
auto-categorisations it made.</p>
<p>These auto-categorisations are based on the mappings included in the
default <a href="https://github.com/aim-rsf/mapmetadata/blob/main/inst/inputs/look_up.csv" class="external-link">look_up.csv</a>.
Type <code>get("look_up")</code> in <code>R</code>.</p>
<p>This look-up file can be changed by the user. ALF refers to
‘Anonymous Linking Field’ - this field is used within datasets that have
been anonymised and encrypted for inclusion within <a href="https://saildatabank.com/governance/privacy-by-design/" class="external-link">SAIL
Databank</a>.</p>
<pre><code> ℹ These are the auto categorised data elements:

  data_element domain_code             note
         ALF_E           2 AUTO CATEGORISED
  ALF_MTCH_PCT           2 AUTO CATEGORISED
    ALF_STS_CD           2 AUTO CATEGORISED
 AVAIL_FROM_DT           1 AUTO CATEGORISED
       GNDR_CD           3 AUTO CATEGORISED
       
Select those you want to manually edit:

1:   ALF_E
2:   ALF_MTCH_PCT
3:   ALF_STS_CD
4:   AVAIL_FROM_DT
5:   GNDR_CD

Enter one or more numbers separated by spaces and then ENTER, or 0 to cancel
1: </code></pre>
<p>Press enter for now, as these look good, but know that you can always
manually overide an auto categorisation. It will then ask you if you
want to review the categorisations you made. Respond 1 to review:</p>
<pre><code>Would you like to review your categorisations? 

1: Yes
2: No

Selection: 1

ℹ These are the data elements you categorised:

         data_element domain_code note (first 12 chars)
              APGAR_1           7                  note
              APGAR_2           7                      
          BIRTH_ORDER           7                  10% missingness    
             BIRTH_TM           1,7                20% missingness      
         BIRTH_WEIGHT           7                      
     BIRTH_WEIGHT_DEC           7                      
 BREASTFEED_8_WKS_FLG           7                      
 BREASTFEED_BIRTH_FLG           7                      
           CHILD_ID_E           2                      
    CURR_LHB_CD_BIRTH           5,7                Place of birth       
               DEL_CD           7                      
                  DOD           3,7             
        ETHNIC_GRP_CD           3                    
             GEST_AGE           3,7                     
  HEALTH_VISITOR_CD_E           2                     

Select those you want to edit:

 1:   APGAR_1                
 2:   APGAR_2                
 3:   BIRTH_ORDER            
 4:   BIRTH_TM               
 5:   BIRTH_WEIGHT        
 ...
 
Enter one or more numbers separated by spaces and then ENTER, or 0 to cancel
1: </code></pre>
<p>If you select a number, it will guide you through that categorisation
again.</p>
<p>All finished! Take a look at the outputs in your project
directory.</p>
</div>
<div class="section level2">
<h2 id="understanding-mapping-outputs">Understanding mapping outputs<a class="anchor" aria-label="anchor" href="#understanding-mapping-outputs"></a>
</h2>
<p>See <a href="https://github.com/aim-rsf/mapmetadata/tree/main/inst/outputs/" class="external-link">here</a>
for outputs generated from the demo run.</p>
<ul>
<li>
<strong>BAR_</strong>360_NationalCommunityChildHealthDatabase(NCCHD)_timestamp.<strong>html</strong>
<ul>
<li>The bar plot that opened in your browser.</li>
</ul>
</li>
<li>
<strong>BAR_</strong>360_NationalCommunityChildHealthDatabase(NCCHD)_timestamp.<strong>csv</strong>
<ul>
<li>The data that created this bar plot.</li>
</ul>
</li>
<li>
<strong>MAPPING_</strong>360_NationalCommunityChildHealthDatabase(NCCHD)_CHILD_timestamp.<strong>csv</strong>
<ul>
<li>The mappings between variables in the CHILD table and the research
domains.</li>
</ul>
</li>
<li>
<strong>L-MAPPING_</strong>360_NationalCommunityChildHealthDatabase(NCCHD)_CHILD_timestamp.<strong>csv</strong>
<ul>
<li>The same mappings as the previous file, but saved in a longer
format. See the argument <code>long_output = TRUE</code> in
<code>metadata_map</code>.</li>
</ul>
</li>
<li>
<strong>MAPPING_LOG_</strong>360_NationalCommunityChildHealthDatabase(NCCHD)_CHILD_timestamp.<strong>csv</strong>
<ul>
<li>A log file that accompanies the MAPPING file, describing features of
the session and the table processed.</li>
</ul>
</li>
<li>
<strong>MAPPING_PLOT_360</strong>_NationalCommunityChildHealthDatabase(NCCHD)_CHILD_timestamp.<strong>png</strong>
<ul>
<li>A simple visual representation of the mappings, displaying the count
of each domain code.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="compare-mapping">Compare mapping<a class="anchor" aria-label="anchor" href="#compare-mapping"></a>
</h2>
<p>Running the function <code>map_compare</code> will allow you to
compare the mappings from two sessions, perhaps two different
researchers. This function compares csv outputs from two sessions, finds
their differences, and asks for a consensus, creating a new output
file:</p>
<p><strong>CONSENSUS_MAPPING_</strong>360_NationalCommunityChildHealthDatabase(NCCHD)_CHILD_timestamp.<strong>csv</strong></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.turing.ac.uk/people/researchers/rachael-stickland" class="external-link">Rachael Stickland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
